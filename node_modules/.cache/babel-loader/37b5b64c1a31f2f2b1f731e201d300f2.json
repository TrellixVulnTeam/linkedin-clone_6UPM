{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jibrilmohamed/Documents/reactJS/linkedin-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jibrilmohamed/Documents/reactJS/linkedin-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{Redirect}from\"react-router\";import{auth,provider,storage}from\"../Firebase\";import db from\"../Firebase\";import{SET_LOADING_STATUS,SET_USER,GET_ARTICLES}from\"./ActionType\";export var setUser=function setUser(payload){return{type:SET_USER,user:payload};};export var setLoading=function setLoading(status){return{type:SET_LOADING_STATUS,status:status};};export var getArticles=function getArticles(payload){return{type:GET_ARTICLES,payload:payload};};export function signInAPI(){return function(dispatch){auth.signInWithPopup(provider).then(function(payload){dispatch(setUser(payload.user));}).catch(function(error){console.log(error);});};}export function getUserAuth(){return function(dispatch){auth.onAuthStateChanged(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(user){dispatch(setUser(user));}case 1:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};}export function signOutAPI(){return function(dispatch){auth.signOut().then(function(){dispatch(setUser(null));}).catch(function(error){return console.log(error.message);});};}export function postArticleAPI(payload){return function(dispatch){dispatch(setLoading(true));if(payload.image!=\"\"){var upload=storage.ref(\"images/\".concat(payload.image.name)).put(payload.image);upload.on(\"state_changed\",function(snapshot){var progress=snapshot.bytesTransferred/snapshot.totalBytes*100;console.log(\"Progress: \".concat(progress,\"%\"));if(snapshot.state===\"RUNNING\"){console.log(\"Progress: \".concat(progress,\"%\"));}},function(error){return console.log(error.code);},/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var downloadURL;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return upload.snapshot.ref.getDownloadURL();case 2:downloadURL=_context2.sent;db.collection(\"articles\").add({actor:{description:payload.user.email,title:payload.user.displayName,date:payload.timestamp,image:payload.user.photoURL},video:payload.video,sharedImg:downloadURL,comments:0,description:payload.description});dispatch(setLoading(false));case 5:case\"end\":return _context2.stop();}}},_callee2);})));}else if(payload.video){db.collection(\"articles\").add({actor:{description:payload.user.email,title:payload.user.displayName,date:payload.timestamp,image:payload.user.photoURL},video:payload.video,sharedImg:\"\",comments:0,description:payload.description});dispatch(setLoading(false));}};}export function getArticlesAPI(){return function(dispatch){var payload;db.collection(\"articles\").orderBy(\"actor.date\",\"desc\").onSnapshot(function(snapshot){payload=snapshot.docs.map(function(doc){return doc.data();});dispatch(getArticles(payload));});};}","map":{"version":3,"sources":["/Users/jibrilmohamed/Documents/reactJS/linkedin-clone/src/action/index.js"],"names":["Redirect","auth","provider","storage","db","SET_LOADING_STATUS","SET_USER","GET_ARTICLES","setUser","payload","type","user","setLoading","status","getArticles","signInAPI","dispatch","signInWithPopup","then","catch","error","console","log","getUserAuth","onAuthStateChanged","signOutAPI","signOut","message","postArticleAPI","image","upload","ref","name","put","on","snapshot","progress","bytesTransferred","totalBytes","state","code","getDownloadURL","downloadURL","collection","add","actor","description","email","title","displayName","date","timestamp","photoURL","video","sharedImg","comments","getArticlesAPI","orderBy","onSnapshot","docs","map","doc","data"],"mappings":"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","sourcesContent":["import { Redirect } from \"react-router\";\nimport { auth, provider, storage } from \"../Firebase\";\nimport db from \"../Firebase\";\nimport { SET_LOADING_STATUS, SET_USER, GET_ARTICLES } from \"./ActionType\";\n\nexport const setUser = (payload) => ({\n  type: SET_USER,\n  user: payload,\n});\nexport const setLoading = (status) => ({\n  type: SET_LOADING_STATUS,\n  status: status,\n});\nexport const getArticles = (payload) => ({\n  type: GET_ARTICLES,\n  payload: payload,\n});\nexport function signInAPI() {\n  return (dispatch) => {\n    auth\n      .signInWithPopup(provider)\n      .then((payload) => {\n        dispatch(setUser(payload.user));\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n}\n\nexport function getUserAuth() {\n  return (dispatch) => {\n    auth.onAuthStateChanged(async (user) => {\n      if (user) {\n        dispatch(setUser(user));\n      }\n    });\n  };\n}\n\nexport function signOutAPI() {\n  return (dispatch) => {\n    auth\n      .signOut()\n      .then(() => {\n        dispatch(setUser(null));\n      })\n      .catch((error) => console.log(error.message));\n  };\n}\n\nexport function postArticleAPI(payload) {\n  return (dispatch) => {\n    dispatch(setLoading(true));\n    if (payload.image != \"\") {\n      const upload = storage\n        .ref(`images/${payload.image.name}`)\n        .put(payload.image);\n      upload.on(\n        \"state_changed\",\n        (snapshot) => {\n          const progress =\n            (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n          console.log(`Progress: ${progress}%`);\n          if (snapshot.state === \"RUNNING\") {\n            console.log(`Progress: ${progress}%`);\n          }\n        },\n        (error) => console.log(error.code),\n        async () => {\n          const downloadURL = await upload.snapshot.ref.getDownloadURL();\n          db.collection(\"articles\").add({\n            actor: {\n              description: payload.user.email,\n              title: payload.user.displayName,\n              date: payload.timestamp,\n              image: payload.user.photoURL,\n            },\n            video: payload.video,\n            sharedImg: downloadURL,\n            comments: 0,\n            description: payload.description,\n          });\n          dispatch(setLoading(false));\n        }\n      );\n    } else if (payload.video) {\n      db.collection(\"articles\").add({\n        actor: {\n          description: payload.user.email,\n          title: payload.user.displayName,\n          date: payload.timestamp,\n          image: payload.user.photoURL,\n        },\n        video: payload.video,\n        sharedImg: \"\",\n        comments: 0,\n        description: payload.description,\n      });\n      dispatch(setLoading(false));\n    }\n  };\n}\n\nexport function getArticlesAPI() {\n  return (dispatch) => {\n    let payload;\n    db.collection(\"articles\")\n      .orderBy(\"actor.date\", \"desc\")\n      .onSnapshot((snapshot) => {\n        payload = snapshot.docs.map((doc) => doc.data());\n        dispatch(getArticles(payload));\n      });\n  };\n}\n"]},"metadata":{},"sourceType":"module"}